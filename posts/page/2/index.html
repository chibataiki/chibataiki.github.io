<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Posts | JiansLife</title>
<meta name="keywords" content="" />
<meta name="description" content="Posts - JiansLife">
<meta name="author" content="chiba">
<link rel="canonical" href="https://chibataiki.github.io/posts/" />
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.c88963fe2d79462000fd0fb1b3737783c32855d340583e4523343f8735c787f0.css" integrity="sha256-yIlj/i15RiAA/Q&#43;xs3N3g8MoVdNAWD5FIzQ/hzXHh/A=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://chibataiki.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://chibataiki.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://chibataiki.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://chibataiki.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://chibataiki.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.92.0" />
<link rel="alternate" type="application/rss+xml" href="https://chibataiki.github.io/posts/index.xml">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="Posts" />
<meta property="og:description" content="JiansLife Blog" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://chibataiki.github.io/posts/" /><meta property="og:site_name" content="JiansLife" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Posts"/>
<meta name="twitter:description" content="JiansLife Blog"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://chibataiki.github.io/posts/"
    }
  ]
}
</script>
</head>

<body class="list" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://chibataiki.github.io/" accesskey="h" title="JiansLife (Alt + H)">JiansLife</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="https://chibataiki.github.io/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="https://chibataiki.github.io/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://chibataiki.github.io/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="https://chibataiki.github.io/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main"> 
<header class="page-header"><div class="breadcrumbs"><a href="https://chibataiki.github.io/">Home</a></div>
  <h1>Posts</h1>
</header>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>Polypyus_about
    </h2>
  </header>
  <section class="entry-content">
    <p>介绍 Polypyus通过对相似二进制文件中已知函数的提取,从而对二进制文件函数进行定位.不需要对二进制文件进行反汇编(). 基于二进制的方式也使得运行速度很快. 但是缺点是需要很多相同架构,相同编译选项的二进制文件.
Polypyus集成了一些现有的工具流程(Giidra, IDA, bindiff, Diaphora). 它可以将已经注释过的函数导入并从中学习,并将找出的函数导出到IDA中. Polypyus的门槛很高,因此只有在作者的实验中能够进行找到正确的匹配. 虽然不过强大但是 将匹配好的结果导入IDA中能够改善IDA的自动分析结果, 然后运行BinDiff
BinDiff: 二进制文件的比较工具,帮助快速找到反汇编代码的相同点和不同点.
解决的问题 IDA 6.8的自动分析比较激进,导致某些误报
DIA 7.2则略保守,导致一些漏报
BinDiff对于byte类型的函数,识别经常会出错. 但是Polupyus则对于byte类型函数识别的很精确. 推测BinDiff的出错原因是: 由于函数的缺失和误报导致生成的控制流图有所不同.有时这些函数已经被DIA所识别,但是IDA不会认为这些是代码或者函数.
Amnesia: ?
Amnesia在找到很多函数的同时也找到了很多的误报. 但是,很多函数初试时设置的栈桢可能是相似的. 因此Polypyus有个设置: 可以通过带有注释的二进制输入文件去学习通用的函数起始地址,并在其他二进制文件中用来识别函数,而不需要匹配函数名.不过该设置只适用于之前没有确认出函数的区域,这样可以避免冲突.
如何工作 Polypyus 收集带有注释的固件二进制文件,通过对共有的函数进行二进制模糊匹配.
支持带注释的文件:
 WICED Studio 的 patch.elf 文件,包含symbol definition most ARM compilers 生成的 .symdefs 文件 .csv 文件  输入的二进制文件的共性越多,polypyus的效果越好.
安装和使用 效果图:
问题在于: annotated binary 哪来!
 referer:
https://github.com/seemoo-lab/polypyus</p>
  </section>
  <footer class="entry-footer"><span title='2020-05-21 21:12:55 +0800 CST'>May 21, 2020</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;chiba</footer>
  <a class="entry-link" aria-label="post link to Polypyus_about" href="https://chibataiki.github.io/posts/polypyus_about/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>Linux Login
    </h2>
  </header>
  <section class="entry-content">
    <p>登陆机制相关文件:
  groups
  passwd
  shaodow
  /etc/group : user group file 用来分配用户组的文件权限?,通过:分为四个部分
 group name group password, x表示密码为空 group ID group包含的用户  Samples: root:\x:0: daemon:\x:1: adm:\x:4:root,syslog /etc/passwd: use names 分为7个部分,通过:分隔
  username
  密码的hash值,或者 x表示密码存储在/etc/shadow中,! 表示passwd被锁定,不能通过密码登陆,但是可以通过(ssh key)登陆, *表示不允许登陆
  uid
  gid
  注释
  用户的home目录
  (可选项) 用户的shell
  sample:
root:\x:0:0:Linux User,,,:/usr/share/ftp_server:/bin/sh ftp:*:95:95::/usr/share/ftp_server:/bin/sh sync:\x:4:65534:sync:/bin:/bin/sync root:!:0:0:root:/tmp:/bin/ash games:\x:5:60:games:/usr/games:/usr/sbin/nologin admin:$1$G555555$99999999999999/:500:500:admin:/tmp:/usr/bin/clish /etc/shadow : user password 只有特权用户可以访问,所以提高了密码的安全性,(这一点上很多嵌入式设备是直接将密码hash嵌入/etc/passwd中,所以不够安全)...</p>
  </section>
  <footer class="entry-footer"><span title='2020-05-08 19:39:41 +0800 CST'>May 8, 2020</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;chiba</footer>
  <a class="entry-link" aria-label="post link to Linux Login" href="https://chibataiki.github.io/posts/linux-users-groups/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>嵌入式设备文件系统分析工具
    </h2>
  </header>
  <section class="entry-content">
    <p>firmwalker https://github.com/craigz28/firmwalker
比较早的一个项目,bash编写,keywords patterns比较单薄
static-firmware-analysis https://github.com/secjey/static-firmware-analysis
灵感来自于firmwalker, 由python编写,比firmwalker多了一写匹配内容
trommel 参考了firmwalker,由python编写,相比来说最为完善
emba https://github.com/e-m-b-a/emba
简单看了下有挺多功能，比较有趣的是对 vulnerable function的检测，但是仅仅只是检测func的数量。</p>
  </section>
  <footer class="entry-footer"><span title='2020-04-07 22:56:58 +0800 CST'>April 7, 2020</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;chiba</footer>
  <a class="entry-link" aria-label="post link to 嵌入式设备文件系统分析工具" href="https://chibataiki.github.io/posts/embedded_device_filesystem_analyze/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>A Large-Scale Analysis of the Security of Embedded Firmwares
    </h2>
  </header>
  <section class="entry-content">
    <p>Abstract first public, large-scale analysis of firmware images.
unpacked 32 thousand firmware images into 1.7 million individual files
show the main benefits of look- ing at many different devices at the same time
discovered a total of 38 previously unknown vulnerabilities in over 693 firmware images.
correlating similar files inside apparently unrelated firmware images
1. Introduction IoT devices:
  Common- Off-The-Shelf (COTS) devices : printers, mobile phones, home routers, and computer components and peripherals....</p>
  </section>
  <footer class="entry-footer"><span title='2020-04-07 22:49:19 +0800 CST'>April 7, 2020</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;chiba</footer>
  <a class="entry-link" aria-label="post link to A Large-Scale Analysis of the Security of Embedded Firmwares" href="https://chibataiki.github.io/posts/a-large-scale-analysis-of-the-security-of-embedded-firmwares/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>shodan usage
    </h2>
  </header>
  <section class="entry-content">
    <p>过滤 include:
filtername:&#34;value&#34;
exclude: - or ! -filtername:&#34;value&#34;
筛选多值: , port: 22,23
Filter: hash hash值为shodan data域的hash
banner text为空的时候,hash值为0
hash:0 Filter: http.html_hash html的hash
很多header存在Date值,此时使用hash值进行过滤就存在 漏报,可以采用http.html的hash值进行过滤
http.html_hash:[hash value] 其他过滤规则类似,可以看raw数据进行筛选
favicon hash值的计算 import mmh3 import requests response = requests.get(&#39;https://website/favicon.ico&#39;) favicon = response.content.encode(&#39;base64&#39;) hash = mmh3.hash(favicon) print(hash)  CLI shodan提供cli接口
python3 -m pip install shodan shodan download [quary] shodan parse --fields ip_str,port,[fields] --separator , [download_file] shodan search --fields ip_str,port,[fields] [quary] ...  referer:
https://help.shodan.io/mastery/property-hashes...</p>
  </section>
  <footer class="entry-footer"><span title='2020-03-29 23:46:15 +0800 CST'>March 29, 2020</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;chiba</footer>
  <a class="entry-link" aria-label="post link to shodan usage" href="https://chibataiki.github.io/posts/shodan/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>Simple_key_validation
    </h2>
  </header>
  <section class="entry-content">
    <p>一种简单的密码加密机制:
#include&lt;stdio.h&gt; #include&lt;stdlib.h&gt; int main(int argc, char *argv[]){ if(argc==2){ printf(&#34;Checking License: %s\n&#34;,argv[1]); int sum=0; for(int i=0;i&lt;strlen(argv[1]);i&#43;&#43;){ sum &#43;= (int)argv[1][i]; } // printf(&#34;%d\n&#34;,sum); if( 1022 == sum){ printf(&#34;Accessed!&#34;); } else { printf(&#34;Wrong!&#34;); } }else { printf(&#34;Usage: %s &lt;key&gt;\n&#34;,argv[0]); } return 0; } 其中1022 是 “THIS IS THE KEY” 进行简单的ascii值求和的结果.
可以通过静态分析和逆向工程可以分析出加密机制.
key generator 根据逆向分析的算法生成注册码
import random def check_key(key): char_sum=0 for c in key: char_sum &#43;= ord(c) return char_sum chars=&#34;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#34; key = &#34;&#34; while True: key &#43;= random....</p>
  </section>
  <footer class="entry-footer"><span title='2020-03-14 22:46:32 +0800 CST'>March 14, 2020</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;chiba</footer>
  <a class="entry-link" aria-label="post link to Simple_key_validation" href="https://chibataiki.github.io/posts/simple_key_validation/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>Netgear-命令注入漏洞分析
    </h2>
  </header>
  <section class="entry-content">
    <p>netgear WNDR3700v4 存在命令注入漏洞,和认证绕过漏洞,相结合就可以未授权任意命令执行.
使用固件版本: V1.0.1.42
固件信息:
LZMA compressed data  Squashfs filesystem, little endian  ELF 32-bit MSB executable, MIPS, MIPS32 version 1 (SYSV)
使用LZMA进行压缩,文件系统为Squashfs, MIPS32,big-end,使用system V 接口
固件里一个/usr/sbin/net-cgi 程序里包含了很多功能,其中一个是 cmd_ping6(),如下:
反编译一下大概就是:
void cmd_ping6(char *target) { char cmd [132]; memset(cmd,0,0x80); sprintf(cmd,&#34;ping6 -c 1 %s &gt; /tmp/ping6_result 2&gt;&amp;1&#34;,target); system(cmd); return; } 这里先将参数target格式化到命令字符串内,并存储在栈中 sprintf(target,&#34;ping6 -c 1 %s &gt; /tmp/ping6_result 2&gt;&amp;1&#34;,target)
因为sprintf 不检验长度,所以存在缓冲区溢出
但是因为下面system函数直接调用了命令字符串,所以可以利用命令注入漏洞而不需要构造ROP链.
system()将参数给/bin/sh进行调用, 所以target设置为: ; evid_command &amp;&gt; /dev/null
那么执行完ping6 后,就会执行恶意命令.
那么就要看如何控制传入cmd_ping6 的参数....</p>
  </section>
  <footer class="entry-footer"><span title='2020-03-04 13:48:11 +0800 CST'>March 4, 2020</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;chiba</footer>
  <a class="entry-link" aria-label="post link to Netgear-命令注入漏洞分析" href="https://chibataiki.github.io/posts/netgear_command_injection_vule_analysis/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>Burpsuite使用note
    </h2>
  </header>
  <section class="entry-content">
    <p>使用 match/replace proxy-&gt;Options-&gt; March and Replace
可以使用regex或者literal
然后HTTP history 页面下方会多出一栏 Auto-modifided request, 点进去就可以看到修改过后的 request
插件 Logger&#43;&#43; This extension can be used to log the requests and responses made by all Burp tools, and display them in a sortable table. It can also save the logged data in CSV format.
Requires Java version 7.
HTTP Request Smuggler This is an extension for Burp Suite designed to help you launch HTTP Request Smuggling attacks....</p>
  </section>
  <footer class="entry-footer"><span title='2020-03-01 22:58:31 +0800 CST'>March 1, 2020</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;chiba</footer>
  <a class="entry-link" aria-label="post link to Burpsuite使用note" href="https://chibataiki.github.io/posts/burpsuite-note/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>MIPS汇编note
    </h2>
  </header>
  <section class="entry-content">
    <p>特性 MIPS和ARM 一样是RISC精简指令集
延迟槽 MIPS I 引入了延迟槽机制,以减少各种指令后流水线的阻塞.
MIPS II 取消了延迟槽机制
MIPS III 是MIPS II的一个后向兼容的扩展,并支持64位.
MIPS …
指令格式 指令:32bits byte : 8bits word: 4bits, halfword: 2bits
MIPS架构中, 指令分为三种类型,R型、I型和J型.
寄存器    Register Number Conventional Name Usage     $0 $zero 硬编码为0   $1 $at 保留给汇编器   $2 - $3 $v0, $v1 保存函数返回值   $4 - $7 $a0 - $a3 存储参数   $8 - $15 $t0 - $t7 存储临时数据   $16 - $23 $s0 - $s7 保存寄存器,存储后面用到的数据   $24 - $25 $t8 - $t9 存储临时数据   $26 - $27 $k0 - $k1 为内核保留   $28 $gp 全局指针   $29 $sp 堆栈指针   $30 $fp 保存栈指针   $31 $ra 返回地址    算数指令 opt $dst, $src, [xx] : $dst = $src &#43; [xx]...</p>
  </section>
  <footer class="entry-footer"><span title='2020-03-01 16:07:18 +0800 CST'>March 1, 2020</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;chiba</footer>
  <a class="entry-link" aria-label="post link to MIPS汇编note" href="https://chibataiki.github.io/posts/mips-assembly-note/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>macOS下IDA插件安装
    </h2>
  </header>
  <section class="entry-content">
    <p> IDAFuzzy : https://github.com/Ga-ryo/IDAFuzzy 在IDA中,对函数进行模糊搜索不是由友好,所以搜了一下,发现了IDAFuzzy  IDA pro 在macOS下安装的坑 和Windows中直接将插件拖到plugin目录不同, macOS的插件安装需要两步
 将ida_fuzzy.py 文件放到 plugins 目录下 将ida_fuzzy.py 所依赖的包放到 python 目录下  可以看到/Applications/IDA Pro 7.0/ida.app/Contents/MacOS中的目录结构:
chibataiki@chibataikis-MBP MacOS % tree -d -L 1 . . ├── cfg ├── dbgsrv ├── idc ├── ids ├── loaders ├── plugins ├── procs ├── python ├── sig └── til </p>
  </section>
  <footer class="entry-footer"><span title='2020-03-01 14:30:18 +0800 CST'>March 1, 2020</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;chiba</footer>
  <a class="entry-link" aria-label="post link to macOS下IDA插件安装" href="https://chibataiki.github.io/posts/ida-plugin-install/"></a>
</article>
<footer class="page-footer">
  <nav class="pagination">
    <a class="prev" href="https://chibataiki.github.io/posts/">« Prev Page</a>
    <a class="next" href="https://chibataiki.github.io/posts/page/3/">Next Page »</a>
  </nav>
</footer>
    </main>
    
<footer class="footer">
    <span>&copy; 2022 <a href="https://chibataiki.github.io/">JiansLife</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
