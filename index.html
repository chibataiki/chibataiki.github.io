<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>JiansLife</title>
<meta name="keywords" content="Blog, Portfolio, PaperMod" />
<meta name="description" content="JiansLife Blog">
<meta name="author" content="chiba">
<link rel="canonical" href="https://chibataiki.github.io/" />
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.c88963fe2d79462000fd0fb1b3737783c32855d340583e4523343f8735c787f0.css" integrity="sha256-yIlj/i15RiAA/Q&#43;xs3N3g8MoVdNAWD5FIzQ/hzXHh/A=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://chibataiki.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://chibataiki.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://chibataiki.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://chibataiki.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://chibataiki.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.92.0" />
<link rel="alternate" type="application/rss+xml" href="https://chibataiki.github.io/index.xml">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="JiansLife" />
<meta property="og:description" content="JiansLife Blog" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://chibataiki.github.io/" /><meta property="og:site_name" content="JiansLife" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="JiansLife"/>
<meta name="twitter:description" content="JiansLife Blog"/>

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Organization",
  "name": "JiansLife",
  "url": "https://chibataiki.github.io/",
  "description": "JiansLife Blog",
  "thumbnailUrl": "https://chibataiki.github.io/favicon.ico",
  "sameAs": [
      
  ]
}
</script>
</head>

<body class="list" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://chibataiki.github.io/" accesskey="h" title="JiansLife (Alt + H)">JiansLife</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="https://chibataiki.github.io/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="https://chibataiki.github.io/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://chibataiki.github.io/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="https://chibataiki.github.io/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main"> 
<article class="first-entry home-info">
    <header class="entry-header">
        <h1>Hi there</h1>
    </header>
    <section class="entry-content">
        <p>Welcome to my blog</p>
    </section>
    <footer class="entry-footer">
        <div class="social-icons">
</div>

    </footer>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>SSD漏洞挖掘从入门到放弃
    </h2>
  </header>
  <section class="entry-content">
    <p>0x00 前研 参加了 “雷克沙杯”HL260s移动硬盘破解挑战赛，记录一下整个过程。
0x01 SSD 组成部分 包含存储芯片部分和USB-to-SATA 转接器两个部分。
存储芯片部分包含4片 longsys 128GB 存储，一共512GB
桥接器芯片正面，包含一个 SOP8的SPI-flash， 另一个芯片不清楚。
​	反面包含一颗 SATA-to-USB 桥接器芯片。
0x02 flash 固件 分析 提取后包含部分 USB descriptor 明文信息和加密固件
USB descriptor:
​	可以得出bridge controller 为 Initio INIC-3638
​	结合芯片信息 符合lexar 相关介绍，但是没有对应datasheet
​
剩下部分为加密固件
0x03 读取分区 使用lexar 原装的 usb-to-sata bridge，可以发现只能识别256GB的块区
usb 2-4.3: New USB device found, idVendor=21c4, idProduct=b061, bcdDevice= 3.06 usb 2-4.3: New USB device strings: Mfr=1, Product=2, SerialNumber=3 usb 2-4.3: Product: HL260S usb 2-4....</p>
  </section>
  <footer class="entry-footer"><span title='2022-01-21 15:13:32 +0800 CST'>January 21, 2022</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;chiba</footer>
  <a class="entry-link" aria-label="post link to SSD漏洞挖掘从入门到放弃" href="https://chibataiki.github.io/posts/ssd%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E6%94%BE%E5%BC%83/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>Gdb Script
    </h2>
  </header>
  <section class="entry-content">
    <p>a sample example
set pagination off set logging file gdb.output set logging on break xxxx.c:[line number] commands silent p p p eod bt c end run set logging off quit run : gdb -x gdb_script -args [program] [program arguments]
reference:
https://sdimitro.github.io/post/scripting-gdb/
https://sourceware.org/gdb/current/onlinedocs/gdb/Break-Commands.html</p>
  </section>
  <footer class="entry-footer"><span title='2021-04-15 19:11:58 +0800 CST'>April 15, 2021</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;chiba</footer>
  <a class="entry-link" aria-label="post link to Gdb Script" href="https://chibataiki.github.io/posts/gdb-script/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>The Design of Metro Map
    </h2>
  </header>
  <section class="entry-content">
    <p>伦敦交通图的最初几个版本很复杂，包含了很多要素:
河流，公园，树木，道路等等，很精确但是要素过多。乘坐地铁的人们显然更加在意如何从一个地铁站到达另一个地铁站。
Harry Beck 设计的地铁图：
三种方向： 上下，左右，以及斜45度。将复杂的地图简化为清晰的几何。在协调一致和特殊要求直接找到了一个很好的平衡。也成为了现代地铁示意图的典范。
referer:
https://www.ted.com/talks/michael_bierut_the_genius_of_the_london_tube_map/transcript?language=en&amp;referrer=playlist-small_thing_big_idea#t-67176
《设计，无处不在》</p>
  </section>
  <footer class="entry-footer"><span title='2020-08-22 20:24:49 +0800 CST'>August 22, 2020</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;chiba</footer>
  <a class="entry-link" aria-label="post link to The Design of Metro Map" href="https://chibataiki.github.io/posts/the-design-of-metro-map/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>FREAK
    </h2>
  </header>
  <section class="entry-content">
    <p>introduction FREAK:(Factoring RSA Export Keys ) 在SSL/TLS协议中存在一种漏洞,允许中间人将ciphersuite中的RSA强度降低为EXPORT-grade(出口级别).
早期由于二战的因素,许多国家出于国家安全因素的考虑,从而限制加密技术的出口;美国政府对出口的加密算法存在限制, 根据法律将出口的RSA密钥长度减少为512bits.而512bit的RSA密钥解密的代价很小,允许美国可以解密国外的加密通讯.
受漏洞影响的相关库:
 OpenSSL :CVE-2015-0204 1.0.1-1.0.1j, 1.0.0-1.0.0o,0.9.8-0.9.8zc BoringSSL: versions before Nov 10, 2014 are vulnerable …  在 OpenSSL 库中，s3_clnt.c 文件中的 ssl3_get_key_exchange 函数允许客户端使用弱RSA密钥对。攻击者可拦截受影响的客户端与服务器之间的HTTPS连接，并强制其使用弱加密。
patch部分: https://github.com/openssl/openssl/commit/ce325c60c74b0fa784f5872404b722e120e5cab0
攻击流程  client在发送的client hello中使用标准的RSA加密请求 MITM 劫持client hello,并将cipher suite 更改为 export-grade RSA,比如TLS_RSA_EXPORT_WITH_RC4_MD5,并传给server server在ServerCertificate中发送2048bits的公钥，接受export级别的cipher suite,并临时生成512bit的RSA公钥, 通过发送ServerKeyExchange message通知client,并使用证书的密钥对公钥进行签名 client端接受消息,验证证书, 生成 premaster key并通过server端的公钥进行加密 mitm attacker需要将512bit的公钥进行因数分解获得临时私钥, mitm 此时可以从clientkeyexchange中解密出pre-master secret 成功解密后attacker可以明文查看所有信息  检测方式:
 服务端:
openssl s_client -connect [server ip] -cipher EXPORT 客户端 https://clienttest....</p>
  </section>
  <footer class="entry-footer"><span title='2020-07-16 18:12:05 +0800 CST'>July 16, 2020</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;chiba</footer>
  <a class="entry-link" aria-label="post link to FREAK" href="https://chibataiki.github.io/posts/freak/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>Sslstrip Use Note
    </h2>
  </header>
  <section class="entry-content">
    <p>sslstrip is a MITM tool.
how it works People may not type https:// (http://) in the address bar.
offen encouter SSL with this two types:
 301/302 redirection click links with https://  sslstrip can watch http traffic and change all https links to http
arpspoof send ARP messages on LAN associate the attacker’s Mac address with the gateway ip, then all traffic will send too attacker’s machine
sudo arpspoof -i [interface] -t [target mac] -r [gataway mac] traffic redirect sudo iptables -t nat -A PREROUTING -p tcp --destination-port 80 -j REDIRECT --to-port 10000 referer:...</p>
  </section>
  <footer class="entry-footer"><span title='2020-06-09 09:16:47 +0800 CST'>June 9, 2020</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;chiba</footer>
  <a class="entry-link" aria-label="post link to Sslstrip Use Note" href="https://chibataiki.github.io/posts/sslstrip-use-note/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>Mitmproxy Use Note
    </h2>
  </header>
  <section class="entry-content">
    <p>一般而言,直接看官方文档就能解决很多问题, 但是实际测试中还是踩了很多坑,所以记录一下
环境: ubuntu 20.04
安装 坑: pip安装存在问题, 需要pipx
how mitm works https://docs.mitmproxy.org/stable/concepts-howmitmproxyworks/
certificate 安装mitmproxy的时候会在 .mitmproxy中默认生产很多认证相关的文件. ubuntu需要手动信任一下
 放到/usr/share/ca-certificates目录下 sudo dpkg-reconfigure ca-certificates  流量转发 开启转发:
sysctl -w net.ipv4.ip_forward=1 sysctl -w net.ipv6.conf.all.forwarding=1 关闭 ICMP包的转发
sysctl -w net.ipv4.conf.all.send_redirects=0 流量转发存在很多形式: https://docs.mitmproxy.org/stable/concepts-modes/
这里讲一下 Transparent的相关问题
选择本地转发的话: 直接iptables 转发流量会遇到的一个问题就是循环转发 iptables -t nat -A OUTPUT -p tcp -dport 80 -j REDIRECT --to-port 8080 这里8080是mitmproxy的代理端口, 所有出去的流量都会转发到8080,但是mitmproxy也需要访问80端口.
所以一个解决方案是新建一个用户mitmproxyuser,让它执行mitmproxy, 然后iptables设置一下不要过滤用户:mitmproxyuser,就可以解决流量循环转发的问题
sudo useradd mitmproxyuser passwd mitmproxyuser iptables -t nat -A OUTPUT -p tcp -m owner !...</p>
  </section>
  <footer class="entry-footer"><span title='2020-06-08 17:21:54 +0800 CST'>June 8, 2020</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;chiba</footer>
  <a class="entry-link" aria-label="post link to Mitmproxy Use Note" href="https://chibataiki.github.io/posts/mitmproxy-use-note/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>Ghidra Usage Note
    </h2>
  </header>
  <section class="entry-content">
    <p>Ghidra plugin for ida ghidra包含了一些用于IDA的插件: 位于 ${GHIDRA_DIR}/Extensions/IDAPro/Python/
mac下插件位置:  /Users/$USER/.idapro/plugins/
xml_exporter.py: 1.a plugin to export an IDA database as an XML file.
2.Place in the IDA plugins folder.
xml_loader.py 1.an IDA loader to build a new database using an XML file.
2.It loads the .bytes file and builds the IDA database using the contents of the XML file.
3.NOTE: Currently, the loader does not support importing memory overlays or Harvard architectures (e....</p>
  </section>
  <footer class="entry-footer"><span title='2020-06-01 13:22:15 +0800 CST'>June 1, 2020</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;chiba</footer>
  <a class="entry-link" aria-label="post link to Ghidra Usage Note" href="https://chibataiki.github.io/posts/ghidra-usage-note/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>IDA_usage_note
    </h2>
  </header>
  <section class="entry-content">
    <p>对于IDA不能识别的二进制文件, 可以选择作为binary file 进行加载.
需要:
 手动设置CPU架构 手动设置加载基址  一旦IDA加载了文件,那么首先做的就是在最开头按下c, 将其转为code.
IDA会将二进制文件的bytes转为code然后进行分析, 但是任然会存在很多没有解析的code.
自动分析binary file 从固件中找到对应的符号文件, 使用IDApython进行符号的修复
TODO referer:
http://www.devttys0.com/2011/07/reverse-engineering-vxworks-firmware-wrt54gv8/</p>
  </section>
  <footer class="entry-footer"><span title='2020-05-28 10:30:54 +0800 CST'>May 28, 2020</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;chiba</footer>
  <a class="entry-link" aria-label="post link to IDA_usage_note" href="https://chibataiki.github.io/posts/ida_usage_note/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>Tp_Link_wr886nv6_VxWorks_firmware_analysis
    </h2>
  </header>
  <section class="entry-content">
    <p>文件系统的提取 看第一篇参考文献的时候,尝试了下,找到了Tp_Link_wr886nv6的固件.
binwalk 扫描结果:
考虑到wr886nv6的内存空间, 这个解压大小2M左右的lzma压缩文件就可能比较有意思.
但是根据binwalk的两个文件初始位置进行分割会有点小问题,所以需要通过hex查看一下真实的有效数据是多大. 类似于这样: 真实数据到 0x00b6b2就结束了
000b6280: 500f 1765 1fee 46eb f9ca c213 2911 9afe P..e..F.....)... 000b6290: 3930 5afb 6f5c 6563 9742 d169 e313 e5ba 90Z.o\ec.B.i.... 000b62a0: 030b ba40 fb20 2705 c2c4 64d9 fe98 78de ...@. &#39;...d...x. 000b62b0: be68 ffff ffff ffff ffff ffff ffff ffff .h.............. ... 000b6ff0: ffff ffff ffff ffff ffff ffff ffff ffff ................ 000b7000: 4d49 4e49 4653 0000 0000 0000 0000 0000 MINIFS....</p>
  </section>
  <footer class="entry-footer"><span title='2020-05-27 16:21:44 +0800 CST'>May 27, 2020</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;chiba</footer>
  <a class="entry-link" aria-label="post link to Tp_Link_wr886nv6_VxWorks_firmware_analysis" href="https://chibataiki.github.io/posts/tp-link_wr886nv6_vxworks_firmware_analysis/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>Polypyus_about
    </h2>
  </header>
  <section class="entry-content">
    <p>介绍 Polypyus通过对相似二进制文件中已知函数的提取,从而对二进制文件函数进行定位.不需要对二进制文件进行反汇编(). 基于二进制的方式也使得运行速度很快. 但是缺点是需要很多相同架构,相同编译选项的二进制文件.
Polypyus集成了一些现有的工具流程(Giidra, IDA, bindiff, Diaphora). 它可以将已经注释过的函数导入并从中学习,并将找出的函数导出到IDA中. Polypyus的门槛很高,因此只有在作者的实验中能够进行找到正确的匹配. 虽然不过强大但是 将匹配好的结果导入IDA中能够改善IDA的自动分析结果, 然后运行BinDiff
BinDiff: 二进制文件的比较工具,帮助快速找到反汇编代码的相同点和不同点.
解决的问题 IDA 6.8的自动分析比较激进,导致某些误报
DIA 7.2则略保守,导致一些漏报
BinDiff对于byte类型的函数,识别经常会出错. 但是Polupyus则对于byte类型函数识别的很精确. 推测BinDiff的出错原因是: 由于函数的缺失和误报导致生成的控制流图有所不同.有时这些函数已经被DIA所识别,但是IDA不会认为这些是代码或者函数.
Amnesia: ?
Amnesia在找到很多函数的同时也找到了很多的误报. 但是,很多函数初试时设置的栈桢可能是相似的. 因此Polypyus有个设置: 可以通过带有注释的二进制输入文件去学习通用的函数起始地址,并在其他二进制文件中用来识别函数,而不需要匹配函数名.不过该设置只适用于之前没有确认出函数的区域,这样可以避免冲突.
如何工作 Polypyus 收集带有注释的固件二进制文件,通过对共有的函数进行二进制模糊匹配.
支持带注释的文件:
 WICED Studio 的 patch.elf 文件,包含symbol definition most ARM compilers 生成的 .symdefs 文件 .csv 文件  输入的二进制文件的共性越多,polypyus的效果越好.
安装和使用 效果图:
问题在于: annotated binary 哪来!
 referer:
https://github.com/seemoo-lab/polypyus</p>
  </section>
  <footer class="entry-footer"><span title='2020-05-21 21:12:55 +0800 CST'>May 21, 2020</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;chiba</footer>
  <a class="entry-link" aria-label="post link to Polypyus_about" href="https://chibataiki.github.io/posts/polypyus_about/"></a>
</article>
<footer class="page-footer">
  <nav class="pagination">
    <a class="next" href="https://chibataiki.github.io/page/2/">Next Page »</a>
  </nav>
</footer>
    </main>
    
<footer class="footer">
    <span>&copy; 2022 <a href="https://chibataiki.github.io/">JiansLife</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
